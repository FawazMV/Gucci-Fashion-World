<%- include('../userSide/includes/singleAndCart') %>

    <div id="top">
        <div class="contain pt-5 mb-5">
            <div class="page-wrapper">
                <main class="main  pt-5 mb-5">
                    <div class="page-header text-center"
                        style="background-image: url('/singlePro/assets/images/page-header-bg.jpg')">
                        <div class="container">
                            <h1 class="page-title">Check out our latest collection</h1>
                        </div><!-- End .container -->
                    </div><!-- End .page-header -->


                    <div class="page-content">
                        <div class="container pt-4">
                            <div class="toolbox">
                                <div class="toolbox-left">
                                    <a href="#" class="sidebar-toggler"><i class="icon-bars"></i>Filters</a>
                                </div><!-- End .toolbox-left -->

                                <div class="toolbox-center">
                                    <div class="toolbox-info">
                                        <!-- Showing <span>12 of 56</span> Products -->
                                    </div>
                                </div>

                                <div class="toolbox-right">
                                    <div class="toolbox-sort">
                                        <label for="sortby">Sort by:</label>
                                        <div class="select-custom">
                                            <select onchange="Select()" name="sortby" id="sortby" class="form-control">
                                                <option value="createdAt">Latest</option>
                                                <option value="shopPrice">Price</option>
                                            </select>
                                        </div>
                                    </div><!-- End .toolbox-sort -->
                                </div><!-- End .toolbox-right -->
                            </div><!-- End .toolbox -->

                            <div class="products">
                                <div class="row" id="ProductsId">
                                    <% for( let i=0; i < Products.length; i++ ) { %>

                                        <div class="col-6 col-md-4 col-lg-4 col-xl-3">
                                            <div class="product">
                                                <figure class="product-media">
                                                    <!-- <span class="product-label label-new">New</span> -->
                                                    <% if (Products[i].quantity==0) { %>
                                                        <span class="badge badge-danger text-white p-4 h3 me-3"
                                                            style="position:absolute;margin-top:50%; z-index:1; width:100%;">Out
                                                            of
                                                            stock</span>

                                                        <% } %>
                                                            <a href="/singelProduct/<%= Products[i]._id %>">
                                                                <img src="<%= Products[i].imagesDetails[0].Location %> "
                                                                    alt="Product image" class="product-image">
                                                            </a>

                                                            <div class="product-action-vertical">

                                                            </div><!-- End .product-action -->

                                                            <div class="product-action action-icon-top">
                                                                <a onclick="addtocart('<%= Products[i]._id %>')"
                                                                    class="btn-product btn-cart"><span>add to
                                                                        cart</span></a>

                                                                <a href="/singelProduct/<%= Products[i]._id %>"
                                                                    class="btn-product btn-quickvieww"
                                                                    title="View"><span>View
                                                                        Detais</span></a>
                                                                <!-- <a href="#" class="btn-product btn-compare"
                                                        title="Compare"><span>compare</span></a> -->
                                                            </div><!-- End .product-action -->
                                                </figure><!-- End .product-media -->

                                                <div class="product-body">
                                                    <div class="product-cat">
                                                        <a href="/product/<%= Products[i].gender.gender %> ">
                                                            <%= Products[i].gender.gender %>
                                                        </a>
                                                    </div><!-- End .product-cat -->
                                                    <h3 class="product-title"><a
                                                            href="/product/<%= Products[i].gender.gender %>">
                                                            <%= Products[i].brandName.brandName %>
                                                                <%= Products[i].type %>
                                                        </a></h3>
                                                    <!-- End .product-title -->
                                                    <div class="product-price">
                                                        â‚¹<%= Products[i].shopPrice %>.00
                                                    </div><!-- End .product-price -->
                                                    <div class="ratings-container">
                                                        <div class="ratings">
                                                            <div class="ratings-val" style="width: 0%;"></div>
                                                            <!-- End .ratings-val -->
                                                        </div><!-- End .ratings -->
                                                        <span class="ratings-text">( 0 Reviews )</span>
                                                    </div><!-- End .rating-container -->

                                                    <div class="product-nav product-nav-dots">
                                                        <a href="#" class="active"
                                                            style="background: <%= Products[i].color1%>;"><span
                                                                class="sr-only">
                                                                <%= Products[i].color1%>
                                                            </span></a>
                                                    </div><!-- End .product-nav -->
                                                </div><!-- End .product-body -->
                                            </div><!-- End .product -->
                                        </div><!-- End .col-sm-6 col-lg-4 col-xl-3 -->
                                        <% } %>

                                            <!-- <div class="col-6 col-md-4 col-lg-4 col-xl-3">
                                                <div class="product">
                                                    <figure class="product-media">
                                                        <a href="product.html">
                                                            <img src="assets/images/products/product-12.jpg"
                                                                alt="Product image" class="product-image">
                                                        </a>

                                                        <div class="product-action-vertical">
                                                            <a href="#"
                                                                class="btn-product-icon btn-wishlist btn-expandable"><span>add
                                                                    to wishlist</span></a>
                                                        </div>

                                                        <div class="product-action action-icon-top">
                                                            <a href="#" class="btn-product btn-cart"><span>add to
                                                                    cart</span></a>
                                                            <a href="popup/quickView.html"
                                                                class="btn-product btn-quickview"
                                                                title="Quick view"><span>quick view</span></a>
                                                            <a href="#" class="btn-product btn-compare"
                                                                title="Compare"><span>compare</span></a>
                                                        </div>
                                                    </figure>
                                                    <div class="product-body">
                                                        <div class="product-cat">
                                                            <a href="#">Bags</a>
                                                        </div>
                                                        <h3 class="product-title"><a href="product.html">Black soft RI
                                                                weekend travel
                                                                bag</a></h3>
                                                        <div class="product-price">
                                                            $68.00
                                                        </div>
                                                        <div class="ratings-container">
                                                            <div class="ratings">
                                                                <div class="ratings-val" style="width: 0%;"></div>
                                                               
                                                            </div>
                                                            <span class="ratings-text">( 0 Reviews )</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>End .col-sm-6 col-lg-4 col-xl-3 -->
                                </div>

                                <!-- <div class="load-more-container text-center">
                        <a href="#" class="btn btn-outline-darker btn-load-more">More Products <i
                                class="icon-refresh"></i></a>
                    </div> -->
                            </div><!-- End .products -->

                            <div class="sidebar-filter-overlay"></div><!-- End .sidebar-filter-overlay -->
                            <aside class="sidebar-shop sidebar-filter">
                                <div class="sidebar-filter-wrapper">
                                    <div class="widget widget-clean">
                                        <label>Filters</label>
                                        <a href="#" class="sidebar-filter-clear">Clean All</a>
                                    </div>
                                    <div class="widget widget-collapsible">
                                        <h3 class="widget-title">
                                            <a data-toggle="collapse" href="#widget-1" role="button"
                                                aria-expanded="true" aria-controls="widget-1">
                                                Category
                                            </a>
                                        </h3>

                                        <div class="collapse show" id="widget-1">
                                            <div class="widget-body">
                                                <div class="filter-items filter-items-count">
                                                    <% for( let i=0; i < gender.length; i++ ) { %>

                                                        <div class="filter-item">
                                                            <div class="custom-control custom-checkbox">
                                                                <input type="checkbox" name="gender"
                                                                    value="<%= gender[i]._id %>"
                                                                    onclick="Select('<%= gender[i]._id %>')"
                                                                    class="gender custom-control-input"
                                                                    id="<%= gender[i]._id %>">
                                                                <label class="custom-control-label"
                                                                    for="<%= gender[i]._id %>">
                                                                    <%= gender[i].gender %>
                                                                </label>
                                                            </div>

                                                        </div>
                                                        <% } %>
                                                </div><!-- End .filter-items -->
                                            </div>
                                        </div>
                                    </div>
                                    <!-- 
                                    <div class="widget widget-collapsible">
                                        <h3 class="widget-title">
                                            <a data-toggle="collapse" href="#widget-2" role="button"
                                                aria-expanded="true" aria-controls="widget-2">
                                                Size
                                            </a>
                                        </h3>

                                        <div class="collapse show" id="widget-2">
                                            <div class="widget-body">
                                                <div class="filter-items">
                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input"
                                                                id="size-1">
                                                            <label class="custom-control-label" for="size-1">XS</label>
                                                        </div>
                                                    </div>

                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input"
                                                                id="size-2">
                                                            <label class="custom-control-label" for="size-2">S</label>
                                                        </div>
                                                    </div>

                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input" checked
                                                                id="size-3">
                                                            <label class="custom-control-label" for="size-3">M</label>
                                                        </div>
                                                    </div>

                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input" checked
                                                                id="size-4">
                                                            <label class="custom-control-label" for="size-4">L</label>
                                                        </div>
                                                    </div>

                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input"
                                                                id="size-5">
                                                            <label class="custom-control-label" for="size-5">XL</label>
                                                        </div>
                                                    </div>

                                                    <div class="filter-item">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input"
                                                                id="size-6">
                                                            <label class="custom-control-label" for="size-6">XXL</label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->

                                    <!-- <div class="widget widget-collapsible">
                                        <h3 class="widget-title">
                                            <a data-toggle="collapse" href="#widget-3" role="button"
                                                aria-expanded="true" aria-controls="widget-3">
                                                Colour
                                            </a>
                                        </h3>

                                        <div class="collapse show" id="widget-3">
                                            <div class="widget-body">
                                                <div class="filter-colors">
                                                    <a href="#" style="background: #b87145;"><span class="sr-only">Color
                                                            Name</span></a>
                                                    <a href="#" style="background: #f0c04a;"><span class="sr-only">Color
                                                            Name</span></a>
                                                    <a href="#" style="background: #333333;"><span class="sr-only">Color
                                                            Name</span></a>
                                                    <a href="#" class="selected" style="background: #cc3333;"><span
                                                            class="sr-only">Color Name</span></a>
                                                    <a href="#" style="background: #3399cc;"><span class="sr-only">Color
                                                            Name</span></a>
                                                    <a href="#" style="background: #669933;"><span class="sr-only">Color
                                                            Name</span></a>
                                                    <a href="#" style="background: #f2719c;"><span class="sr-only">Color
                                                            Name</span></a>
                                                    <a href="#" style="background: #ebebeb;"><span class="sr-only">Color
                                                            Name</span></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->

                                    <div class="widget widget-collapsible">
                                        <h3 class="widget-title">
                                            <a data-toggle="collapse" href="#widget-4" role="button"
                                                aria-expanded="true" aria-controls="widget-4">
                                                Brands
                                            </a>
                                        </h3>

                                        <div class="collapse show" id="widget-4">
                                            <div class="widget-body">
                                                <div class="filter-items">
                                                    <% for( let i=0; i < brands.length; i++ ) { %>
                                                        <div class="filter-item">
                                                            <div class="custom-control custom-checkbox">
                                                                <input type="checkbox"
                                                                    onclick="Select('<%= brands[i]._id %>') "
                                                                    class="brandId custom-control-input"
                                                                    value="<%= brands[i]._id %>"
                                                                    id="<%= brands[i]._id %> ">
                                                                <label class="custom-control-label"
                                                                    for="<%= brands[i]._id %> ">
                                                                    <%= brands[i].brandName %>
                                                                </label>
                                                            </div>
                                                        </div>

                                                        <% } %>




                                                </div><!-- End .filter-items -->
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- End .sidebar-filter-wrapper -->
                            </aside><!-- End .sidebar-filter -->
                        </div><!-- End .container -->
                    </div><!-- End .page-content -->
                </main><!-- End .main -->
            </div>
        </div>
    </div>
    <button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>

    <!-- Mobile Menu -->



    <script>
        addtocart = (id) => {
            try {
                axios.post('/addCart', { id: id }).then((e) => {
                    if (e.data.response === "login") location.href = "/login"
                    else if (e.data.response) {
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'Sorry, ' + e.data.response
                        })
                    } else {
                        Swal.fire({
                            icon: 'success',
                            title: 'Product added to cart',
                            showConfirmButton: false,
                            timer: 1500
                        })
                    }
                })
            }
            catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Sorry,' + error.message
                })
            }
        }
    </script>


    <script>
        function Select(id) {
            let sortt = document.getElementById('sortby').value
            let filter = $('.gender:checkbox:checked')
            let filter2 = $('.brandId:checkbox:checked')
            let gender = []
            let brand = []
            for (let i = 0; i < filter.length; i++) gender.push(filter[i].defaultValue)
            for (let i = 0; i < filter2.length; i++) brand.push(filter2[i].defaultValue)
            axios.get('/productFilter', { params: { gender: gender, brand: brand, sortt: sortt } }).then((e) => {
                let Products = e.data.Products
                let html = ""
                for (let i = 0; i < Products.length; i++) {
                    html +=
                        `
                                        <div class="col-6 col-md-4 col-lg-4 col-xl-3">
                                            <div class="product">
                                                <figure class="product-media">
                                                    <!-- <span class="product-label label-new">New</span> -->`
                                                     if (Products[i].quantity==0) {

                                                html +=        ` <span class="badge badge-danger p-4 h3 me-3"
                                                            style="position:absolute;margin-top:50%; z-index:1; width:100%;">Out
                                                            of
                                                            stock</span>`

                                                         } 
                                             html +=        `<a href="/singelProduct/${Products[i]._id}">
                                                        <img src="${Products[i].imagesDetails[0].Location} "
                                                            alt="Product image" class="product-image">
                                                    </a>

                                                    <div class="product-action-vertical">

                                                    </div><!-- End .product-action -->

                                                    <div class="product-action action-icon-top">
                                                        <a onclick="addtocart('${Products[i]._id}')"
                                                            class="btn-product btn-cart"><span>add to
                                                                cart</span></a>

                                                        <a href="/singelProduct/${Products[i]._id}"
                                                            class="btn-product btn-quickvieww" title="View"><span>View
                                                                Detais</span></a>
                                                        <!-- <a href="#" class="btn-product btn-compare"
                                                        title="Compare"><span>compare</span></a> -->
                                                    </div><!-- End .product-action -->
                                                </figure><!-- End .product-media -->

                                                <div class="product-body">
                                                    <div class="product-cat">
                                                        <a href="/product/${Products[i].gender.gender} ">
                                                            ${Products[i].gender.gender}
                                                        </a>
                                                    </div><!-- End .product-cat -->
                                                    <h3 class="product-title"><a
                                                            href="/product/${Products[i].gender.gender}">
                                                            ${Products[i].brandName.brandName}
                                                                ${Products[i].type}
                                                        </a></h3>
                                                    <!-- End .product-title -->
                                                    <div class="product-price">
                                                        â‚¹${Products[i].shopPrice}.00
                                                    </div><!-- End .product-price -->
                                                    <div class="ratings-container">
                                                        <div class="ratings">
                                                            <div class="ratings-val" style="width: 0%;"></div>
                                                            <!-- End .ratings-val -->
                                                        </div><!-- End .ratings -->
                                                        <span class="ratings-text">( 0 Reviews )</span>
                                                    </div><!-- End .rating-container -->

                                                    <div class="product-nav product-nav-dots">
                                                        <a href="#" class="active"
                                                            style="background: ${Products[i].color1};"><span
                                                                class="sr-only">
                                                                ${Products[i].color1}
                                                            </span></a>
                                                    </div><!-- End .product-nav -->
                                                </div><!-- End .product-body -->
                                            </div><!-- End .product -->
                                        </div><!-- End .col-sm-6 col-lg-4 col-xl-3 -->  `
                }
                document.getElementById('ProductsId').innerHTML = html

            })
        }
    </script>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
</head>
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap"
    rel="stylesheet">
<!-- Css Styles -->
<link rel="stylesheet" href="/user/assets/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="/user/assets/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="/user/assets/css/elegant-icons.css" type="text/css">
<link rel="stylesheet" href="/user/assets/css/magnific-popup.css" type="text/css">
<link rel="stylesheet" href="/user/assets/css/nice-select.css" type="text/css">
<link rel="stylesheet" href="/user/assets/css/owl.carousel.min.css" type="text/css">
<link rel="stylesheet" href="/user/assets/css/slicknav.min.css" type="text/css">
<link rel="stylesheet" href="/user/assets/css/style.css" type="text/css">


<!-- ***** Main Banner Area Start ***** -->

<div id="top">
    <div class="contain pt-5 mb-5">
        <div class="page-wrapper">
            <main class="main pt-1 mb-5">
                <section class="checkout spad">
                    <div class="container">
                        <div class="checkout__form">
                            <form action="#">
                                <div class="row">
                                    <div class="col-lg-7 col-md-6">

                                        <h6 class="checkout__title">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                                fill="currentColor" class="bi bi-geo-alt" viewBox="0 0 20 20">
                                                <path
                                                    d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493 0 0 1 8 14.58a31.481 31.481 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z" />
                                                <path
                                                    d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                                            </svg>Delivery Address
                                        </h6>
                                        <div class="checkout__input px-2">
                                            <div style="width:65%;">
                                                <h6 class="fw-bold">Muhammed Fawaz MV</h6>
                                                <p style="opacity:70%;">Baithussalam, pullumkunnu, vaidhyarangadi po,
                                                    ramanattukara,
                                                    kozhikode, pin :673633,
                                                    <br> malappuram, kerala <br>
                                                    india - 673633 <br>
                                                    Phone : 9995516519
                                                </p>
                                                <button type="button" onclick="changeaddress()"
                                                    class="btn btn-link pl-0 fw-bold mt-3" data-toggle="modal"
                                                    data-target="#exampleModalLong">
                                                    <span class="text-black" style="opacity:70%;"> <svg
                                                            xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                            fill="currentColor" class="bi bi-vector-pen"
                                                            viewBox="0 0 18 18">
                                                            <path fill-rule="evenodd"
                                                                d="M10.646.646a.5.5 0 0 1 .708 0l4 4a.5.5 0 0 1 0 .708l-1.902 1.902-.829 3.313a1.5 1.5 0 0 1-1.024 1.073L1.254 14.746 4.358 4.4A1.5 1.5 0 0 1 5.43 3.377l3.313-.828L10.646.646zm-1.8 2.908-3.173.793a.5.5 0 0 0-.358.342l-2.57 8.565 8.567-2.57a.5.5 0 0 0 .34-.357l.794-3.174-3.6-3.6z" />
                                                            <path fill-rule="evenodd"
                                                                d="M2.832 13.228 8 9a1 1 0 1 0-1-1l-4.228 5.168-.026.086.086-.026z" />
                                                        </svg></span>
                                                    <span style="opacity:80%;"> Change Address </span>
                                                </button>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-md-6">
                                        <div class="checkout__order">
                                            <h5 class="order__title">Your order</h5>
                                            <div class="checkout__order__products fw-bold">Product <span>Total</span>
                                            </div>
                                            <ul class="checkout__total__products">
                                                <% for( let i=0; i < cartproduct.length; i++ ) { %>
                                                    <li>
                                                        <%= i+1 %> . <%= cartproduct[i].product_id.brandName.brandName
                                                                %> <span>₹ <%= cartproduct[i].product_id.shopPrice %>
                                                                        .00</span>
                                                    </li>
                                                    <% } %>
                                            </ul>
                                            <ul class="checkout__total__all">
                                                <li>Subtotal <span>₹ <%- total %>.00 </span></li>
                                                <li>Shipping charge <span>₹ 70.00</span></li>
                                                <li>Total <span>₹<%- total+70 %>.00 </span></li>
                                            </ul>
                                            <div class="checkout__input__checkbox">
                                                <label class="fw-bold">
                                                    Payment Options
                                                </label>
                                            </div>

                                            <div>
                                                <label>
                                                    <input type="radio" name="payment" class="mx-2" value="cod" />Cash
                                                    on delivery</label>
                                            </div>
                                            <div>
                                                <label>
                                                    <input type="radio" class="mx-2" value="paypal"
                                                        name="payment" />Paypal</label>
                                            </div>
                                            <button type="submit" onclick="placeorder()" class="site-btn">PLACE
                                                ORDER</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
</div>




<!-- Button trigger modal -->

<!-- Modal -->
<div class="modal fade" id="exampleModalLong" tabindex="-1" aria-labelledby="exampleModalLong" aria-hidden="true">
    <div class="modal-body">
        <div class="container-fluid">
            <div class="row">

                <div class="col-md-6 ml-auto">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Change Address</h5>
                                <button type="button" class="btn btn-link p-0 fw-bold" data-toggle="modal"
                                    data-target="#addBackdrop"> Add address
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="p-3" id="addressshow">
                                    <div>
                                        <h6 class="fw-bold">Muhammed Fawaz MV</h6>
                                        <p style="opacity:70%;">Baithussalam, pullumkunnu, vaidhyarangadi po,
                                            ramanattukara,
                                            kozhikode, pin :673633,
                                            <br> malappuram, kerala <br>
                                            india - 673633 <br>
                                            Phone : 9995516519
                                        </p>
                                        <div class="d-flex justify-content-between">
                                            <button class="btn btn-warning">Select</button>
                                            <button type="button" class="btn btn-link pl-0 fw-bold float-end"
                                                data-toggle="modal" data-target="#staticBackdrop">
                                                <span class="text-black" style="opacity:70%;"> <svg
                                                        xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                        fill="currentColor" class="bi bi-vector-pen"
                                                        viewBox="0 0 18 18">
                                                        <path fill-rule="evenodd"
                                                            d="M10.646.646a.5.5 0 0 1 .708 0l4 4a.5.5 0 0 1 0 .708l-1.902 1.902-.829 3.313a1.5 1.5 0 0 1-1.024 1.073L1.254 14.746 4.358 4.4A1.5 1.5 0 0 1 5.43 3.377l3.313-.828L10.646.646zm-1.8 2.908-3.173.793a.5.5 0 0 0-.358.342l-2.57 8.565 8.567-2.57a.5.5 0 0 0 .34-.357l.794-3.174-3.6-3.6z" />
                                                        <path fill-rule="evenodd"
                                                            d="M2.832 13.228 8 9a1 1 0 1 0-1-1l-4.228 5.168-.026.086.086-.026z" />
                                                    </svg></span>
                                                <span style="opacity:80%;" class="text-black"> Edit </span>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    -
</div>


<!--Edit Modal -->
<div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-body">
        <div class="container-fluid">
            <div class="row">

                <div class="col-md-6 ml-auto">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Edit Address</h5>

                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="px-3">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="checkout__input">
                                                <form action="">
                                                    <p>Fist Name<span>*</span></p>
                                                    <input name="firstname" type="text">
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="checkout__input">
                                                <p>Last Name<span>*</span></p>
                                                <input name="lastname" type="text">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="checkout__input">
                                        <p>Country<span></span></p>
                                        <input type="text" name="country" value="India" disabled>
                                    </div>
                                    <div class="checkout__input">
                                        <p>Address<span>*</span></p>
                                        <textarea name="address" id="" style="width:100%;" rows="3"></textarea>
                                    </div>
                                    <div class="checkout__input">
                                        <p>Town/City<span>*</span></p>
                                        <input name="city" type="text">
                                    </div>
                                    <div class="checkout__input">
                                        <p>State<span>*</span></p>
                                        <input name="state" type="text">
                                    </div>

                                    <div class="row">
                                        <div class="col-lg-5">
                                            <div class="checkout__input">
                                                <p>Pincode<span>*</span></p>
                                                <input name="pincode" type="text">
                                            </div>
                                        </div>
                                        <div class="col-lg-7">
                                            <div class="checkout__input">
                                                <p>Phone<span>*</span></p>
                                                <input name="phone" type="text">
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary">Update</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Add address  -->
<div class="modal fade" id="addBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-body">
        <div class="container-fluid">
            <div class="row">

                <div class="col-md-6 ml-auto">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Add Address</h5>

                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="px-3">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="checkout__input">

                                                <form action="" id="addAddress">
                                                    <p>Fist Name<span>*</span></p>
                                                    <input name="firstname" class="text-dark"
                                                        onkeydown="return /[a-z]/i.test(event.key)" type="text"
                                                        required>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="checkout__input">
                                                <p>Last Name<span>*</span></p>
                                                <input name="lastname" class="text-dark"
                                                    onkeydown="return /[a-z]/i.test(event.key)" type="text" required>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="checkout__input">
                                        <p>Country<span></span></p>
                                        <input type="text" name="country" class="text-dark" value="India" disabled>
                                    </div>
                                    <div class="checkout__input">
                                        <p>Address<span>*</span></p>
                                        <textarea name="address" id="" class="text-dark" required style="width:90%;"
                                            rows="3"></textarea>
                                    </div>
                                    <div class="checkout__input">
                                        <p>Town/City<span>*</span></p>
                                        <input name="city" class="text-dark" onkeydown="return /[a-z]/i.test(event.key)"
                                            required type="text">
                                    </div>
                                    <div class="checkout__input">
                                        <p>State<span>*</span></p>
                                        <input name="state" class="text-dark"
                                            onkeydown="return /[a-z]/i.test(event.key)" required type="text">
                                    </div>

                                    <div class="row">
                                        <div class="col-lg-5">
                                            <div class="checkout__input">
                                                <p>Pincode<span>*</span></p>
                                                <input name="pincode" class="text-dark"
                                                    onkeypress="return isNumberKey(event)" required type="text">
                                            </div>
                                        </div>
                                        <div class="col-lg-7">
                                            <div class="checkout__input">
                                                <p>Phone<span>*</span></p>
                                                <input name="phone" class="text-dark"
                                                    onkeypress="return isNumberKey(event)" required type="text">
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" id="addButton" class="btn btn-secondary"
                                    data-dismiss="modal">Close</button>
                                <button type="submit" onclick="addressformCheck()" class="btn btn-primary">Add</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function changeaddress() {
        try {
            axios.get('/getAddress').then(e => {

                if (e.data.response) {

                } else {
                    let address = e.data.address
                    let div = ``

                    for (let i = 0; i < address.length; i++) {

                        div += ` <div class="mt-4">
                                        <h6 class="fw-bold">${address[i].firstname} ${address[i].lastname}</h6>
                                        <p style="opacity:70%;">${address[i].address}
                                            <br> ${address[i].city}, ${address[i].state} <br>
                                            India - ${address[i].pincode} <br>
                                            Phone : ${address[i].phone}
                                        </p>
                                        <div class="d-flex justify-content-between">`
                        if (address[i].default) {
                            div += ` <button onclick="select('${address[i]._id}')" class="btn btn-success" disabled>Selected</button>`
                        }
                        else {

                            div += ` <button onclick="select('${address[i]._id}')" class="btn btn-warning">Select</button>`
                        }
                        div += `
                                            <button type="button" class="btn btn-link pl-0 fw-bold float-end"
                                                data-toggle="modal" data-target="#staticBackdrop">
                                                <span class="text-black" style="opacity:70%;"> <svg
                                                        xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                        fill="currentColor" class="bi bi-vector-pen"
                                                        viewBox="0 0 18 18">
                                                        <path fill-rule="evenodd"
                                                            d="M10.646.646a.5.5 0 0 1 .708 0l4 4a.5.5 0 0 1 0 .708l-1.902 1.902-.829 3.313a1.5 1.5 0 0 1-1.024 1.073L1.254 14.746 4.358 4.4A1.5 1.5 0 0 1 5.43 3.377l3.313-.828L10.646.646zm-1.8 2.908-3.173.793a.5.5 0 0 0-.358.342l-2.57 8.565 8.567-2.57a.5.5 0 0 0 .34-.357l.794-3.174-3.6-3.6z" />
                                                        <path fill-rule="evenodd"
                                                            d="M2.832 13.228 8 9a1 1 0 1 0-1-1l-4.228 5.168-.026.086.086-.026z" />
                                                    </svg></span>
                                                <span style="opacity:80%;" onclick="editaddress('${address[i]._id}')" class="text-black"> Edit </span>
                                            </button>
                                        </div>
                                    </div>
                                    <hr>`
                    }

                    document.getElementById('addressshow').innerHTML = div
                }

            })

        }

        catch (error) {

        }
    }



    const loginForm = document.getElementById("addAddress");
    loginForm.addEventListener("submit", handleSubmit);
    async function handleSubmit(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const formProps = await Object.fromEntries(formData);

        try {
            axios.post('/addAddress', formProps).then(e => {

                if (e.data.response) {

                } else {
                    let address = e.data.address
                    let div = ``

                    for (let i = 0; i < address.length; i++) {

                        div += ` <div>
                                        <h6 class="fw-bold">${address[i].firstname} ${address[i].lastname}</h6>
                                        <p style="opacity:70%;">${address[i].address}
                                            <br> ${address[i].city}, ${address[i].state} <br>
                                            India - ${address[i].pincode} <br>
                                            Phone : ${address[i].phone}
                                        </p>
                                        <div class="d-flex justify-content-between">`
                        if (address[i].default) {
                            div += ` <button onclick="select('${address[i]._id}')" class="btn btn-warning">Select</button>`
                        }
                        else {

                            div += ` <button onclick="select('${address[i]._id}')" class="btn btn-warning">Select</button>`
                        }
                        div += `
                                            <button type="button" class="btn btn-link pl-0 fw-bold float-end"
                                                data-toggle="modal" data-target="#staticBackdrop">
                                                <span class="text-black" style="opacity:70%;"> <svg
                                                        xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                        fill="currentColor" class="bi bi-vector-pen"
                                                        viewBox="0 0 18 18">
                                                        <path fill-rule="evenodd"
                                                            d="M10.646.646a.5.5 0 0 1 .708 0l4 4a.5.5 0 0 1 0 .708l-1.902 1.902-.829 3.313a1.5 1.5 0 0 1-1.024 1.073L1.254 14.746 4.358 4.4A1.5 1.5 0 0 1 5.43 3.377l3.313-.828L10.646.646zm-1.8 2.908-3.173.793a.5.5 0 0 0-.358.342l-2.57 8.565 8.567-2.57a.5.5 0 0 0 .34-.357l.794-3.174-3.6-3.6z" />
                                                        <path fill-rule="evenodd"
                                                            d="M2.832 13.228 8 9a1 1 0 1 0-1-1l-4.228 5.168-.026.086.086-.026z" />
                                                    </svg></span>
                                                <span style="opacity:80%;" onclick="editaddress('${address[i]._id}')" class="text-black"> Edit </span>
                                            </button>
                                        </div>
                                    </div>`
                    }
                    document.getElementById('addressshow').innerHTML = div
                    document.getElementById('addButton').click()
                }

            })
        }
        catch (error) {

        }
    }

</script>



<script>
    function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : evt.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57))
            return false;
        return true;
    }
    placeorder = () => {

        let abc = document.getElementsByName('payment')
        abc.forEach((item) => {
            confirm(item)
        })

    }
</script>



<script>
    function select(id){
        axios.put('/default',{id:id}).then(e=>{

        })
    }
</script>